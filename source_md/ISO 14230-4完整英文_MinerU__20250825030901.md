# INTERNATIONAL STANDARD

ISO 14230- 4

First edition 2000- 06- 01

# Road vehicles — Diagnostic systems — Keyword Protocol 2000 —

# Part 4: Requirements for emission-related systems

Véhicules routiers — Systèmes de diagnostic — Protocole «Keyword 2000» —

Partie 4: Exigences pour les systèmes relatifs aux émissions

# PDF disclaimer

This PDF file may contain embedded typefaces. In accordance with Adobe's licensing policy, this file may be printed or viewed but shall not be edited unless the typefaces which are embedded are licensed to and installed on the computer performing the editing. In downloading this file, parties accept therein the responsibility of not infringing Adobe's licensing policy. The ISO Central Secretariat accepts no liability in this area.

Adobe is a trademark of Adobe Systems Incorporated.

Details of the software products used to create this PDF file can be found in the General Info relative to the file; the PDF- creation parameters were optimized for printing. Every care has been taken to ensure that the file is suitable for use by ISO member bodies. In the unlikely event that a problem relating to it is found, please inform the Central Secretariat at the address given below.

$\circledcirc$  ISO2000

# Foreword

ISO (the International Organization for Standardization) is a worldwide federation of national standards bodies (ISO member bodies). The work of preparing International Standards is normally carried out through ISO technical committees. Each member body interested in a subject for which a technical committee has been established has the right to be represented on that committee. International organizations, governmental and non- governmental, in liaison with ISO, also take part in the work. ISO collaborates closely with the International Electrotechnical Commission (IEC) on all matters of electrotechnical standardization.

International Standards are drafted in accordance with the rules given in the ISO/IEC Directives, Part 3.

Draft International Standards adopted by the technical committees are circulated to the member bodies for voting. Publication as an International Standard requires approval by at least  $75\%$  of the member bodies casting a vote.

Attention is drawn to the possibility that some of the elements of this part of ISO 14230 may be the subject of patent rights. ISO shall not be held responsible for identifying any or all such patent rights.

International Standard ISO 14230- 4 was prepared by Technical Committee ISO/TC 22, Road vehicles, Subcommittee SC 3, Electrical and electronic equipment.

ISO 14230 consists of the following parts, under the general title Road vehicles - - Diagnostic systems - - Keyword Protocol 2000:

- Part 1: Physical layer- Part 2: Data link layer- Part 3: Application layer- Part 4: Requirements for emission-related systems

# Road vehicles - Diagnostic systems - Keyword Protocol 2000 -

# Part 4: Requirements for emission-related systems

# 1 Scope

This part of ISO 14230 specifies the requirements for the Keyword Protocol 2000 (KWP 2000) data link and connected vehicle and scan tool when used to comply with on- board diagnostic (OBD) requirements for emission- related test data.

This part of ISO 14230 only specifies requirements relative to the Keyword Protocol 2000 for OBD purposes. Complete specification can be found in ISO 14230 parts 1 to 3 and in ISO 14229. ISO 14230- 1, ISO 14230- 2 and ISO 14230- 3 are applicable for OBD purposes only as explicitly referenced in this part of ISO 14230.

# 2 Normative references

The following normative documents contain provisions which, through reference in this text, constitute provisions of this part of ISO 14230. For dated references, subsequent amendments to, or revisions of, any of these publications do not apply. However, parties to agreements based on this part of ISO 14230 are encouraged to investigate the possibility of applying the most recent editions of the normative documents indicated below. For undated references, the latest edition of the normative document referred to applies. Members of ISO and IEC maintain registers of currently valid International Standards.

ISO 9141- 2:1994, Road vehicles - - Diagnostic systems - - Part 2: CARB requirements for interchange of digital in formation.

ISO 14229:1998, Road vehicles - - Diagnostic systems - - Diagnostic services specification.

ISO 14230- 1:1999, Road vehicles - - Diagnostic systems - - Keyword Protocol 2000 - - Part 1: Physical layer.

ISO 14230- 2:1999, Road vehicles - - Diagnostic systems - - Keyword Protocol 2000 - - Part 2: Data link layer.

ISO 14230- 3:1999, Road vehicles - - Diagnostic systems - - Keyword Protocol 2000 - - Part 3: Application layer.

ISO 15031- 5: - 1), Road vehicles - - Communication between vehicle and external equipment for emission- related diagnostics - - Part 5: Emission- related diagnostic services.

# 3 Physical layer

All of ISO 14230- 1 is applicable for OBD purposes, except for the restrictions defined below.

There is no restriction for the physical layer. It should be noted that ISO 14230- 1 and ISO 9141- 2 physical layers are fully compatible. The only difference between these two standards is that ISO 14230- 1 additionally supports  $24~\mathrm{V}$  systems. Testers meeting this part of ISO 14230 are not required to support communications with  $24~\mathrm{V}$  systems.

The baud rate is specified by the protocol and shall not be determined by measurement.

# 4 Data link layer

# 4.1 General

4.1 GeneralAll of ISO 14230- 2 is applicable for OBD purposes, except for the restrictions given in 4.2 to 4.6.

# 4.2 Message structure

The header shall always consist of three bytes.

An optional length byte shall not be used. Data length shall be limited to 7 bytes for compatibility with ISO 15031- 5.

Bits A1A0 of format byte  $= 11$  , with address information and functional addressing shall be used for request mes- . sages.

Bits A1A0 of format byte  $= 10$  , with address information and physical addressing shall be used for response mes- . sages.

Functional address 33H shall be used as target address for messages sent to the vehicle.

Target address of the responses shall be the source address included in the request.

Source address of the responses shall be the physical address of the ECUs.

# 4.3 Timing

4.3 TimingOnly the normal timing parameter set with default values shall be used for both the vehicle and the scan tool. Timing exceptions as described in ISO 14230- 2 are not allowed.

# 4.4 StartCommunication service

ECU(s) (OBD related) shall only support one of the two following methods of initialisation:

5 baud initialisation; fast initialisation.

The scan tool shall support both methods: 5 baud initialisation; fast initialisation.

Keywords received by the scan tool can be 2025, 2027, 2029 and 2031. In any case, the scan tool and the vehicle shall only use the functionality of keyword 2025 (i.e. 3 byte header, no additional length byte, normal timing).

In the case where 5 baud initialisation is used, then the 5 baud address shall be 33H and subsequent communication shall take place at 10 400 baud.

# 4.5 StopCommunication service

This service may be used by the scan tool to stop the communication but shall be supported by the vehicle.

# 4.6 AccessTimingParameter service

The scan tool shall not support this service.

# 5 Diagnostic services

# 5.1 General

5.1 GeneralAll sections of ISO 14229 and ISO 14230- 3 are applicable for OBD purposes, except for the restrictions given in 5.2 to 5.5.

# 5.2 Emission related services

5.2 Emission related servicesSpecification and implementation of emissions- related diagnostic services are specified in ISO 15031- 5.

# 5.3 TesterPresent service

5.3 TesterPresent serviceThe vehicle shall support the TesterPresent service to keep the communication active. This service shall be used within P3 by the scan tool to maintain communication with the vehicle in case no test mode request is needed at this moment. No optional parameter shall be used, meaning that there shall always be a response to a request. The scan tool may support the TesterPresent service or use another method to keep communication active.

# 5.4 Other diagnostic services

Support of the other diagnostic services is not required by this part of ISO 14230.

# 5.5Negative responses

A module shall always respond to a request either with positive or negative response when no transmission error has been detected. Format and usage of negative responses are defined in ISO 14230- 3.

In case a negative response is used, the response code included shall be one of the following:

10 GeneralReject 11 ServiceNotSupported 12 SubFunctionNotSupported- InvalidFormat 21 Busy- RepeatRequest 22 ConditionsNotCorrect or RequestSequenceError 78 RequestCorrectlyReceived- ResponsePending

All negative responses with response code 78 included shall be sent by the modules within P2. The modules shall terminate with a positive response or a negative response with a code different from 78.

The scan tool shall ignore the content of the negative response messages and shall not perform the error handling actions as specified in ISO 14230- 3, but shall wait for another P2 time- out.

# ICS 43.180

Price based on 3 pages